#include <Wire.h>
#include <MPU6050.h>

MPU6050 accel;

#define BUZZER_PIN 8 // Buzzer connected to pin 8

void setup() {
  Serial.begin(9600);
  Wire.begin();
  accel.initialize();

  // If accelerometer connection fails, stop the program
  if (!accel.testConnection()) {
    Serial.println("Accelerometer connection failed!");
    while (1); // Infinite loop to stop the program
  }

  pinMode(BUZZER_PIN, OUTPUT); // Set buzzer pin as output
}

void loop() {
  int16_t ax, ay, az;
  accel.getAcceleration(&ax, &ay, &az);

  // Calculate G-force (assuming raw values from accelerometer)
  float ax_g = ax / 16384.0;
  float ay_g = ay / 16384.0;
  float az_g = az / 16384.0;

  // Print acceleration values to the serial monitor
  Serial.print("ax: "); Serial.print(ax_g);
  Serial.print(" ay: "); Serial.print(ay_g);
  Serial.print(" az: "); Serial.println(az_g);

  // If any axis exceeds 4g, turn the buzzer on
  if (abs(ax_g) > 4.0 || abs(ay_g) > 4.0 || abs(az_g) > 4.0) {
    digitalWrite(BUZZER_PIN, HIGH); // Turn buzzer on
  } else {
    digitalWrite(BUZZER_PIN, LOW); // Turn buzzer off
  }

  delay(100); // Short delay before next reading
}
